# TODO

## Tooling

- [x] biome (lint + format: tab, double quotes, semicolons, lineWidth 100)
- [x] TypeScript (strict mode, ES2022, bundler moduleResolution)
- [x] vitest (test runner + v8 coverage provider)
- [x] tsup (ESM + CJS dual output, sourcemap, dts)
- [x] changesets (versioning & release, @changesets/changelog-github)
- [x] lefthook (pre-commit: biome check on staged files)
- [x] pnpm@10.14.0 (pinned via packageManager field)

## Phase 1: Core

### 1.1 Project Setup

- [x] package.json — type: module, engines: node>=20, sideEffects: false
- [x] tsconfig.json — strict, ES2022, bundler resolution, declaration + declarationMap + sourceMap
- [x] biome.json — recommended rules, tab indent, 100 char, double quotes, semicolons always
- [x] vitest.config.ts — v8 provider, coverage 100% thresholds (statements/branches/functions/lines)
- [x] tsup.config.ts — entry points (index, integrations/zod, integrations/valibot), ESM+CJS, dts, clean, sourcemap, external: hono
- [x] .editorconfig — tab indent, lf, utf-8, trim trailing whitespace
- [x] .gitignore — node_modules, dist, coverage, *.tsbuildinfo, .DS_Store
- [x] lefthook.yml — pre-commit: biome check on staged *.{js,ts,jsx,tsx,json}
- [x] publishConfig — access: public, provenance: true

### 1.2 CI / CD

- [x] `.github/workflows/ci.yml`
  - push to main + pull_request to main
  - Node.js matrix: 20, 22, 24
  - Steps: checkout → setup pnpm → setup node (cache) → install --frozen-lockfile → lint → typecheck → vitest run --coverage → build
  - `ci-pass` guard job (needs: ci, fails if ci fails)
- [x] `.github/workflows/release.yml`
  - push to main, concurrency control
  - permissions: contents/pull-requests/id-token write
  - changesets/action@v1 for auto release PR creation + npm publish
  - secrets: GITHUB_TOKEN, NPM_TOKEN
- [ ] GitHub branch ruleset — require ci-pass on main branch

### 1.3 Coverage Target

- [x] vitest.config.ts with 100% thresholds on all metrics:
  - statements: 100
  - branches: 100
  - functions: 100
  - lines: 100
- [x] Coverage include: `src/**/*.ts`
- [x] Coverage exclude: `src/index.ts`, `src/types.ts` (re-exports / type-only files)

### 1.4 Type Definitions

- [x] `src/types.ts` — ProblemDetails, ProblemDetailsInput, ProblemDetailsHandlerOptions
- [ ] Tests: type inference verification (tsd or vitest type tests)

### 1.5 Status Code Mapping

- [x] `src/status.ts` — statusToPhrase(), statusToSlug()
- [x] Tests (22 tests): common status codes, unknown status, slug generation

### 1.6 ProblemDetailsError

- [x] `src/error.ts` — ProblemDetailsError class
- [x] `src/factory.ts` — problemDetails() factory function
- [x] Tests (7 tests): F1-F6 + unknown status fallback

### 1.7 Error Handler

- [x] `src/handler.ts` — problemDetailsHandler()
- [x] Tests (13 tests): H1-H11 + defaultType + unknown status via mapError

## Phase 2: Validator Integration

### 2.1 zodProblemHook

- [x] `src/integrations/zod.ts` — zodProblemHook()
- [x] Tests (7 tests): Z1-Z7

### 2.2 valibotProblemHook

- [x] `src/integrations/valibot.ts` — valibotProblemHook()
- [x] Subpath export: `./valibot`
- [x] Tests (8 tests): V1-V7 + root-level validation without path

## Phase 3: Community & Docs

### 3.1 Community Files

- [x] CONTRIBUTING.md — dev setup, commands, TDD workflow, code style (biome), changeset usage
- [x] CODE_OF_CONDUCT.md — Contributor Covenant v2.1
- [x] SECURITY.md — supported versions, report via GitHub Security Advisories, response timeline
- [x] LICENSE (MIT)

### 3.2 GitHub Templates

- [x] `.github/FUNDING.yml`
- [x] `.github/ISSUE_TEMPLATE/bug_report.yml` — version, Hono version, runtime, reproduction steps
- [x] `.github/ISSUE_TEMPLATE/feature_request.yml` — problem, proposed solution, alternatives
- [x] `.github/PULL_REQUEST_TEMPLATE.md` — Summary, Related Issues, checklist (tests/typecheck/lint/changeset)

### 3.3 Packaging

- [x] README.md (English) — RFC 9457 compliance, usage examples, Zod/Valibot integration
- [x] Subpath exports (`.` → core, `./zod` → Zod, `./valibot` → Valibot)
- [ ] npm publish + JSR publish
- [ ] CHANGELOG.md — auto-generated by changesets

## Phase 4: Publish & Integrate

### 4.1 npm / JSR Publish

- [ ] npm publish (via changesets)
- [ ] JSR publish

### 4.2 Hono Ecosystem

- [ ] Comment on [honojs/middleware #579](https://github.com/honojs/middleware/issues/579)
- [ ] Submit third-party listing PR to honojs/middleware

### 4.3 Existing Library Integration

- [ ] PR to migrate hono-idempotency errors.ts to hono-problem-details
- [ ] PR to migrate hono-webhook-verify errors.ts to hono-problem-details

## Stretch Goals

- [x] OpenAPI integration (`hono-problem-details/openapi`) — ProblemDetailsSchema, createProblemDetailsSchema, problemDetailsResponse for @hono/zod-openapi
- [ ] Standard Schema integration (`hono-problem-details/standard-schema`) — ArkType support
- [ ] i18n — title/detail localization
- [ ] Problem type registry — helpers for defining/managing custom problem types
- [ ] Express adapter — alternative to express-http-problem-details
